!function(){"use strict";function e(e){var t=function(e){return this.source=e||document,this.source.find=function(e,n){var i=this.querySelector(e);return n=n||!1,i?new t(i):(n||console.warn("failed to find: "+e),!1)},this.source.findAll=function(e){var n,i=this.querySelectorAll(e),r=[];for(n=0;n<i.length;n++)r.push(new t(i[n]));return r},this.source.data=function(){return this.dataset},this.source.html=function(e){return e?(this.innerHTML=e.trim(),this):this.innerHTML},this.source.css=function(e,t){return this.style[e]=t,this},this.source.hide=function(){return this.css("display","none"),this},this.source.show=function(){return this.css("display","block"),this},this.source.removeClass=function(e){return this.classList.remove(e),this},this.source.addClass=function(e){return this.classList.add(e),this},this.source.hasClass=function(e){return this.classList.contains(e)},this.source.toggleClasses=function(e,t){var n,i=this.classList;return i.contains(e)&&(n=e,e=t,t=n),this.addClass(e),this.removeClass(t),this},this.source.attr=function(e,t){return e&&!t?this.getAttribute(e):void(e&&t&&this.setAttribute(e,t))},this.source.replaceElement=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),this.parentNode.replaceChild(t.firstChild,this),this},this.source.insertElement=function(e,n,i){i=i||!1;var r=document.createElement(e);return Object.keys(n).forEach(function(e){r[e]=n[e]}),this.appendChild(r),i?new t(r):this},this.source.insertAfter=function(e,n,i){i=i||!1;var r=document.createElement(e);return Object.keys(n).forEach(function(e){r[e]=n[e]}),this.parentNode.insertBefore(r,this.nextSibling),i?new t(r):this},this.source.remove=function(){return this.parentNode.removeChild(this),this},this.source};return new t(e)}function t(){var e=function(){this.list={}};return e.prototype.on=function(e,t){return this.list[e]=t,this},e.prototype.trigger=function(e){if("undefined"==typeof this.list[e])throw new Error(e+": event does not exists");return-1==e.indexOf("ing")&&console.info(e),this.list[e].apply(this,arguments),this},new e}function n(e){var t=e.$container.find("video");return t.playing=!1,t.onloadeddata=function(){e.event.trigger("video:loaded")},t.playVideo=function(){this.play(),this.playing=!0},t.pauseVideo=function(){this.pause()},t.stopVideo=function(){this.currentTime=0,this.pauseVideo()},t.mute=function(){this.muted=!0},t.unMute=function(){this.muted=!1},t.getDuration=function(){return this.duration},t.getCurrentTime=function(){return this.currentTime},t.finished=function(){var e=this.getCurrentTime()>=this.getDuration();return e&&(this.playing=!1),e},t.seekTo=function(e){return this.currentTime=e,e},t}function i(t){var n="video",i=e(document).find("script["+n+"]"),r=i.attr(n),s='\n        <div class="player__container" id="'+r+'">\n            <div class="player__poster hideme" style="background-image: url(http://img.youtube.com/vi/'+r+'/hqdefault.jpg);"></div>\n            <span class="player__play hideme"><span class="icon-play"></span></span>\n            <video class="player__video"></video>\n            <div class="player__controls hidden">\n                <progress class="player__progress" min="0" max="0" value="0"></progress>\n                <div class="left">\n                    <span class="icon-play"></span>\n                    <span class="time">\n                        <span class="current">00:00</span> / <span class="total">00:00</span>\n                    </span>\n                </div>\n                <div class="right">\n                    <span class="icon-volume2"></span>\n                    <span class="icon-fullscreen"></span>\n                </div>\n            </div>\n            <div class="player__share hidden">\n                <span class="icon-share1"></span>                <span class="icon-facebook-sq"></span>                <span class="icon-twitter-sq"></span>            </div>\n            <div class="player__code">\n                <span class="close">&#x2715;</span>\n                <span>Add this code to your website</span>\n                <textarea rows="2">'+i.outerHTML.trim()+"</textarea>\n            </div>\n        </div>";return d(),i.replaceElement(s),r}function r(e){var t=Math.floor(e/60),e=Math.floor(e%60);return t=9>=t?"0"+t:t,e=9>=e?"0"+e:e,[t,e].join(":")}function s(e){return e.layerX*this.max/this.offsetWidth}function o(e){e.$els.controls.removeClass("hidden"),e.$els.share.removeClass("hidden")}function a(e){e.$els.controls.addClass("hidden"),e.$els.share.addClass("hidden")}function l(e){var t=e.event,n=e.$els,i=e.$video;t.on("vast:ready",function(){e.vastTracker._events["skip-countdown"]=function(n){var i=e.$container.find(".vastCountdown");if(n=Math.round(n),i){if(n>0)return i.show(),i.html("Skip in "+n+".."),!1;i.addClass("done"),i.html("Skip"),i.onclick=function(){t.trigger("video:next","skipped")}}}}),t.on("video:next",function(n,i){var r=e.$container.find(".vastTarget"),s=e.$container.find(".vastCountdown");r&&r.remove(),s&&s.remove(),t.trigger("yt:init")}),t.on("video:init",function(){var n=!e.vast.sources||0==e.vast.sources.length;if(n)return e.$els.play.hide(),t.trigger("video:next","sourceless"),!1;var r=0;i.src=e.vast.sources[r].src,i.insertAfter("a",{href:e.vastTracker.clickThroughURLTemplate,className:"vastTarget",target:"_blank"}),i.insertAfter("span",{className:"vastCountdown"},!0),e.$container.find(".vastTarget").onclick=function(){var t=e.vastTracker.clickTrackingURLTemplates;t&&e.vastTracker.trackURLs(t)}}),t.on("video:play",function(){n.hideme.forEach(function(e){e.hide()}),i.playVideo()}),t.on("video:loaded",function(){t.trigger("video:play"),e.vastTracker.load()}),t.on("video:playing",function(){return i.playing?(e.vastTracker.setProgress(i.getCurrentTime()),i.finished()?(e.vastTracker.complete(),t.trigger("video:next","complete"),!1):void 0):!1}),t.on("yt:init",function(){e.yt=new YT.Player(i,{videoId:e.videoId,playerVars:{enablejsapi:1,disablekb:1,controls:0,showinfo:0,modestbranding:1,rel:0,autoplay:0,iv_load_policy:3,fs:0},events:{onReady:function(t){var n=(e.$container.find(".player__video"),e.yt.getDuration()-1);e.$els.progress.attr("max",n),e.$els.timeTotal.html(r(n)),e.$els.timeCurrent.html(r(0)),e.yt.ended=function(){return 0==e.yt.status},e.yt.isPlaying=function(){return 1==e.yt.status},e.yt.isPaused=function(){return 2==e.yt.status},e.yt.muted=!1,e.yt.isFullscreen=!1,e.yt.playVideo()},onStateChange:function(n){var i={0:"ended",1:"playing",2:"paused"};e.yt.status=n.data,i[n.data]&&t.trigger("yt:"+i[n.data])}}})}),t.on("yt:playing",function(){e.yt.isPlaying()&&(e.$els.hideme.forEach(function(e){e.hide()}),e.$els.playBtn.addClass("icon-pause"),e.$els.playBtn.removeClass("icon-play"),e.$els.code.hide())}),t.on("yt:paused",function(){e.yt.isPaused()&&(e.$els.playBtn.addClass("icon-play"),e.$els.playBtn.removeClass("icon-pause"))}),t.on("yt:ended",function(){e.yt.ended()&&(e.$els.playBtn.addClass("icon-play"),e.$els.playBtn.removeClass("icon-pause"))}),t.on("yt:mute",function(){return e.yt.muted?(e.$els.volumeBtn.addClass("icon-volume2"),e.$els.volumeBtn.removeClass("icon-mute"),e.yt.muted=!e.yt.muted,void e.yt.unMute()):(e.$els.volumeBtn.addClass("icon-mute"),e.$els.volumeBtn.removeClass("icon-volume2"),e.yt.muted=!e.yt.muted,e.yt.mute(),!1)}),t.on("yt:full",function(){var t,n=e.$container.find("iframe"),i=document;return e.yt.isFullscreen?(e.yt.isFullscreen=!1,t=i.exitFullscreen||i.msExitFullscreen||i.mozCancelFullScreen||i.webkitExitFullscreen,void t.bind(i)()):(e.yt.isFullscreen=!0,t=n.requestFullScreen||n.mozRequestFullScreen||n.webkitRequestFullScreen,t.bind(n)(),i.onkeyup=function(t){e.yt.isFullscreen&&"escape"==t.code.toLowerCase()&&(e.yt.isFullscreen=!1)},!1)}),t.on("yt:progressing",function(){var t,n=e.yt&&"function"==typeof e.yt.isPlaying;n&&e.yt.isPlaying()&&(t=e.yt.getCurrentTime(),e.$els.progress.attr("value",t),e.$els.timeCurrent.html(r(t)))}),t.on("yt:jump",function(t,n){e.yt.seekTo(n),e.$els.progress.attr("value",n),e.$els.timeCurrent.html(r(n))})}function u(e){e.$els.play.onclick=function(){e.event.trigger("video:init")},e.$els.playBtn.onclick=function(){e.yt.isPlaying()&&e.yt.pauseVideo(),(e.yt.ended()||e.yt.isPaused())&&e.yt.playVideo()},e.$els.volumeBtn.onclick=function(){e.event.trigger("yt:mute")},e.$els.fullBtn.onclick=function(){e.event.trigger("yt:full")},e.$els.progress.onclick=function(t){t.preventDefault(),t.stopPropagation(),e.event.trigger("yt:jump",s.call(this,t))},e.$container.onmouseover=function(){return e.yt?void o(e):!1},e.$container.onmouseout=function(){return e.yt?void a(e):!1},e.$els.fbBtn.onclick=function(){e.yt.pauseVideo(),FB.ui({method:"share",mobile_iframe:!0,href:"http://google.com"},function(e){})},e.$els.twBtn.onclick=function(t){e.yt.pauseVideo(),window.open("https://twitter.com/share?url="+escape(parent.top.location.href)+"&text=hello","","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600")},e.$els.codeBtn.onclick=function(){e.$els.code.show(),e.yt.pauseVideo()},e.$els.textarea.onclick=function(){this.select()},e.$els.codeClose.onclick=function(){e.$els.code.hide(),e.yt.playVideo()}}function c(e){return e.settings.url?void DMVAST.client.get(e.settings.url,function(t){if(t)for(var n=0;n<t.ads.length;n++){var i=t.ads[n];e.vast.companion=void 0;for(var r=0;r<i.creatives.length;r++){var s=i.creatives[r],o=!1,a=!1;if("linear"!==s.type||o)"companion"!==s.type||a||(e.vast.companion=s,a=!0);else if(s.mediaFiles.length){if(e.vast.sources=f(s.mediaFiles),!e.vast.sources.length)return void e.event.trigger("ad:canceled");e.vastTracker=new DMVAST.tracker(i,s),o=!0}}if(e.vastTracker){e.event.trigger("vast:ready");break}vast.util.track(i.errorURLTemplates,{ERRORCODE:403})}e.vastTracker||e.event.trigger("ad:canceled")}):!1}function h(r){var s=this;this.settings=r,this.videoId=i(this),this.$container=e(document).find("#"+this.videoId),this.$video=new n(this),this.yt=null,this.$els={play:this.$container.find(".player__play"),hideme:this.$container.findAll(".hideme"),controls:this.$container.find(".player__controls"),share:this.$container.find(".player__share"),timeCurrent:this.$container.find(".player__controls .time .current"),timeTotal:this.$container.find(".player__controls .time .total"),progress:this.$container.find("progress"),playBtn:this.$container.find(".player__controls .icon-play"),volumeBtn:this.$container.find(".player__controls .icon-volume2"),fullBtn:this.$container.find(".player__controls .icon-fullscreen"),fbBtn:this.$container.find(".player__share .icon-facebook-sq"),twBtn:this.$container.find(".player__share .icon-twitter-sq"),codeBtn:this.$container.find(".player__share .icon-share1"),code:this.$container.find(".player__code"),codeClose:this.$container.find(".player__code .close"),textarea:this.$container.find(".player__code textarea")},this.event=new t,this.vast={},l(this),u(this),c(this),setInterval(function(){s.event.trigger("video:playing"),s.event.trigger("yt:progressing")},1e3)}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.DMVAST=e()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,s,l,u,c=arguments,h=this;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),l=1;i>l;l++)s[l-1]=c[l];n.apply(this,s)}else if(o(n)){for(i=arguments.length,s=new Array(i-1),l=1;i>l;l++)s[l-1]=c[l];for(u=n.slice(),i=u.length,l=0;i>l;l++)u[l].apply(h,s)}return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n,i=this;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&i.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)i.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],2:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[]}return e}(),t.exports=i},{}],3:[function(e,t,n){var i,r,s;r=e("./parser"),s=e("./util"),i=function(){function e(){}return e.cappingFreeLunch=0,e.cappingMinimumTimeInterval=0,e.options={withCredentials:!1,timeout:0},e.get=function(e,t,i){var s,o,a;return o=+new Date,s=n.extend=function(e,t){var n,i;for(n in t)i=t[n],e[n]=i;return e},i||("function"==typeof t&&(i=t),a={}),a=s(this.options,t),this.totalCallsTimeout<o?(this.totalCalls=1,this.totalCallsTimeout=o+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls?void i(null):o-this.lastSuccessfullAd<this.cappingMinimumTimeInterval?void i(null):r.parse(e,a,function(e){return function(e){return i(e)}}(this))},function(){var t,n;n=s.storage,t=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(i){t(e,i,{get:function(){return n.getItem(i)},set:function(e){return n.setItem(i,e)},configurable:!1,enumerable:!0})}),null==e.totalCalls&&(e.totalCalls=0),null==e.totalCallsTimeout&&(e.totalCallsTimeout=0)}(),e}(),t.exports=i},{"./parser":9,"./util":15}],4:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}}return e}(),t.exports=i},{}],5:[function(e,t,n){var i,r,s,o,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=function(){function e(){this.trackingEvents={}}return e}(),s=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null}return l(t,e),t}(i),o=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(i),r=function(e){function t(){this.type="companion",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(i),t.exports={VASTCreativeLinear:s,VASTCreativeNonLinear:o,VASTCreativeCompanion:r}},{}],6:[function(e,t,n){t.exports={client:e("./client"),tracker:e("./tracker"),parser:e("./parser"),util:e("./util")}},{"./client":3,"./parser":9,"./tracker":11,"./util":15}],7:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}return e}(),t.exports=i},{}],8:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.width=0,this.height=0,this.minSuggestedDuration="00:00:00",this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null}return e}(),t.exports=i},{}],9:[function(e,t,n){var i,r,s,o,a,l,u,c,h,p,d,f,v=[].indexOf||function(e){for(var t=this,n=0,i=this.length;i>n;n++)if(n in t&&t[n]===e)return n;return-1};r=e("./urlhandler"),d=e("./response"),s=e("./ad"),f=e("./util"),l=e("./creative").VASTCreativeLinear,a=e("./creative").VASTCreativeCompanion,u=e("./creative").VASTCreativeNonLinear,c=e("./mediafile"),o=e("./companionad"),h=e("./nonlinear"),i=e("events").EventEmitter,p=function(){function e(){}var t;return t=[],e.addURLTemplateFilter=function(e){"function"==typeof e&&t.push(e)},e.removeURLTemplateFilter=function(){return t.pop()},e.countURLTemplateFilters=function(){return t.length},e.clearUrlTemplateFilters=function(){return t=[]},e.parse=function(e,t,n){return n||("function"==typeof t&&(n=t),t={}),this._parse(e,null,t,function(e,t){return n(t)})},e.vent=new i,e.track=function(e,t){return this.vent.emit("VAST-error",t),f.track(e,t)},e.on=function(e,t){return this.vent.on(e,t)},e.once=function(e,t){return this.vent.once(e,t)},e._parse=function(e,n,i,s){var o,a,l;for(s||("function"==typeof i&&(s=i),i={}),a=0,l=t.length;l>a;a++)o=t[a],e=o(e);return null==n&&(n=[]),n.push(e),r.get(e,i,function(t){return function(r,o){var a,l,u,c,h,p,f,m,g,y,T;if(null!=r)return s(r);if(h=new d,null==(null!=o?o.documentElement:void 0)||"VAST"!==o.documentElement.nodeName)return s();for(y=o.documentElement.childNodes,p=0,m=y.length;m>p;p++)c=y[p],"Error"===c.nodeName&&h.errorURLTemplates.push(t.parseNodeText(c));for(T=o.documentElement.childNodes,f=0,g=T.length;g>f;f++)c=T[f],"Ad"===c.nodeName&&(a=t.parseAdElement(c),null!=a?h.ads.push(a):t.track(h.errorURLTemplates,{ERRORCODE:101}));for(l=function(e){var n,i,r;if(null==e&&(e=!1),h){for(r=h.ads,n=0,i=r.length;i>n;n++)if(a=r[n],null!=a.nextWrapperURL)return;return 0===h.ads.length&&(e||t.track(h.errorURLTemplates,{ERRORCODE:303}),h=null),s(null,h)}},u=h.ads.length;u--;)a=h.ads[u],null!=a.nextWrapperURL&&!function(r){var s,o,a;return n.length>=10||(a=r.nextWrapperURL,v.call(n,a)>=0)?(t.track(r.errorURLTemplates,{ERRORCODE:302}),h.ads.splice(h.ads.indexOf(r),1),void l()):(0===r.nextWrapperURL.indexOf("//")?(o=location.protocol,r.nextWrapperURL=""+o+r.nextWrapperURL):-1===r.nextWrapperURL.indexOf("://")&&(s=e.slice(0,e.lastIndexOf("/")),r.nextWrapperURL=""+s+"/"+r.nextWrapperURL),t._parse(r.nextWrapperURL,n,i,function(e,n){var i,s,o,a,u,c,p,d,f,v,m,g,y,T,k,L,w,R;if(s=!1,null!=e)t.track(r.errorURLTemplates,{ERRORCODE:301}),h.ads.splice(h.ads.indexOf(r),1),s=!0;else if(null==n)t.track(r.errorURLTemplates,{ERRORCODE:303}),h.ads.splice(h.ads.indexOf(r),1),s=!0;else for(h.errorURLTemplates=h.errorURLTemplates.concat(n.errorURLTemplates),a=h.ads.indexOf(r),h.ads.splice(a,1),k=n.ads,p=0,d=k.length;d>p;p++){if(u=k[p],u.errorURLTemplates=r.errorURLTemplates.concat(u.errorURLTemplates),u.impressionURLTemplates=r.impressionURLTemplates.concat(u.impressionURLTemplates),null!=r.trackingEvents)for(L=u.creatives,g=0,f=L.length;f>g;g++)if(i=L[g],"linear"===i.type||"nonlinear"===i.type)for(w=Object.keys(r.trackingEvents),y=0,v=w.length;v>y;y++)o=w[y],(c=i.trackingEvents)[o]||(c[o]=[]),i.trackingEvents[o]=i.trackingEvents[o].concat(r.trackingEvents[o]);if(null!=r.videoClickTrackingURLTemplates)for(R=u.creatives,T=0,m=R.length;m>T;T++)i=R[T],"linear"!==i.type&&"nonlinear"!==i.type||(i.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates.concat(r.videoClickTrackingURLTemplates));h.ads.splice(a,0,u)}return delete r.nextWrapperURL,l(s)}))}(a);return l()}}(this))},e.childByName=function(e,t){var n,i,r,s;for(s=e.childNodes,i=0,r=s.length;r>i;i++)if(n=s[i],n.nodeName===t)return n},e.childsByName=function(e,t){var n,i,r,s,o;for(i=[],o=e.childNodes,r=0,s=o.length;s>r;r++)n=o[r],n.nodeName===t&&i.push(n);return i},e.parseAdElement=function(e){var t,n,i,r,s=this;for(r=e.childNodes,n=0,i=r.length;i>n;n++){if(t=r[n],t.id=e.getAttribute("id"),"Wrapper"===t.nodeName)return s.parseWrapperElement(t);if("InLine"===t.nodeName)return s.parseInLineElement(t)}},e.parseWrapperElement=function(e){var t,n,i,r,s,o,a;for(t=this.parseInLineElement(e),r=this.childByName(e,"VASTAdTagURI"),null!=r?t.nextWrapperURL=this.parseNodeText(r):(r=this.childByName(e,"VASTAdTagURL"),null!=r&&(t.nextWrapperURL=this.parseNodeText(this.childByName(r,"URL")))),a=t.creatives,s=0,o=a.length;o>s;s++)n=a[s],i=null,"linear"!==n.type&&"nonlinear"!==n.type||(i=n,null!=i&&(null!=i.trackingEvents&&(t.trackingEvents=i.trackingEvents),null!=i.videoClickTrackingURLTemplates&&(t.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates)));return null!=t.nextWrapperURL?t:void 0},e.parseInLineElement=function(e){var t,n,i,r,o,a,l,u,c,h,p,d,f,v,m=this;for(t=new s,t.id=e.id,d=e.childNodes,a=0,c=d.length;c>a;a++)switch(o=d[a],o.nodeName){case"Error":t.errorURLTemplates.push(m.parseNodeText(o));break;case"Impression":t.impressionURLTemplates.push(m.parseNodeText(o));break;case"Creatives":for(f=m.childsByName(o,"Creative"),l=0,h=f.length;h>l;l++)for(i=f[l],v=i.childNodes,u=0,p=v.length;p>u;u++)switch(r=v[u],r.nodeName){case"Linear":n=m.parseCreativeLinearElement(r),n&&t.creatives.push(n);break;case"NonLinearAds":n=m.parseNonLinear(r),n&&t.creatives.push(n);break;case"CompanionAds":n=m.parseCompanionAd(r),n&&t.creatives.push(n)}}return t},e.parseCreativeLinearElement=function(e){var t,n,i,r,s,o,a,u,h,p,d,f,v,m,g,y,T,k,L,w,R,_,C,x,b,E,N,A,U,B,$,D,I,S,F,O,M=this;if(i=new l,i.duration=this.parseDuration(this.parseNodeText(this.childByName(e,"Duration"))),-1===i.duration&&"Wrapper"!==e.parentNode.parentNode.parentNode.nodeName)return null;if(v=e.getAttribute("skipoffset"),null==v?i.skipDelay=null:"%"===v.charAt(v.length-1)?(d=parseInt(v,10),i.skipDelay=i.duration*(d/100)):i.skipDelay=this.parseDuration(v),T=this.childByName(e,"VideoClicks"),null!=T){for(i.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(T,"ClickThrough")),$=this.childsByName(T,"ClickTracking"),L=0,C=$.length;C>L;L++)n=$[L],i.videoClickTrackingURLTemplates.push(M.parseNodeText(n));for(D=this.childsByName(T,"CustomClick"),w=0,x=D.length;x>w;w++)r=D[w],i.videoCustomClickURLTemplates.push(M.parseNodeText(r))}for(t=this.childByName(e,"AdParameters"),null!=t&&(i.adParameters=this.parseNodeText(t)),I=this.childsByName(e,"TrackingEvents"),R=0,b=I.length;b>R;R++)for(g=I[R],S=M.childsByName(g,"Tracking"),_=0,E=S.length;E>_;_++)if(m=S[_],s=m.getAttribute("event"),y=M.parseNodeText(m),null!=s&&null!=y){if("progress"===s){if(p=m.getAttribute("offset"),!p)continue;s="%"===p.charAt(p.length-1)?"progress-"+p:"progress-"+Math.round(M.parseDuration(p))}null==(k=i.trackingEvents)[s]&&(k[s]=[]),i.trackingEvents[s].push(y)}for(F=this.childsByName(e,"MediaFiles"),U=0,N=F.length;N>U;U++)for(h=F[U],O=M.childsByName(h,"MediaFile"),B=0,A=O.length;A>B;B++)u=O[B],a=new c,a.id=u.getAttribute("id"),a.fileURL=M.parseNodeText(u),a.deliveryType=u.getAttribute("delivery"),a.codec=u.getAttribute("codec"),a.mimeType=u.getAttribute("type"),a.apiFramework=u.getAttribute("apiFramework"),a.bitrate=parseInt(u.getAttribute("bitrate")||0),a.minBitrate=parseInt(u.getAttribute("minBitrate")||0),a.maxBitrate=parseInt(u.getAttribute("maxBitrate")||0),a.width=parseInt(u.getAttribute("width")||0),a.height=parseInt(u.getAttribute("height")||0),f=u.getAttribute("scalable"),f&&"string"==typeof f&&(f=f.toLowerCase(),"true"===f?a.scalable=!0:"false"===f&&(a.scalable=!1)),o=u.getAttribute("maintainAspectRatio"),o&&"string"==typeof o&&(o=o.toLowerCase(),"true"===o?a.maintainAspectRatio=!0:"false"===o&&(a.maintainAspectRatio=!1)),i.mediaFiles.push(a);return i},e.parseNonLinear=function(e){var t,n,i,r,s,o,a,l,c,p,d,f,v,m,g,y,T,k,L,w,R,_,C,x,b,E,N,A,U,B=this;for(t=new u,x=this.childsByName(e,"TrackingEvents"),f=0,y=x.length;y>f;f++)for(c=x[f],b=B.childsByName(c,"Tracking"),v=0,T=b.length;T>v;v++)l=b[v],n=l.getAttribute("event"),p=B.parseNodeText(l),null!=n&&null!=p&&(null==(d=t.trackingEvents)[n]&&(d[n]=[]),t.trackingEvents[n].push(p));for(E=this.childsByName(e,"NonLinear"),m=0,k=E.length;k>m;m++){for(o=E[m],s=new h,s.id=o.getAttribute("id")||null,s.width=o.getAttribute("width"),s.height=o.getAttribute("height"),s.minSuggestedDuration=o.getAttribute("minSuggestedDuration"),s.apiFramework=o.getAttribute("apiFramework"),N=B.childsByName(o,"HTMLResource"),g=0,L=N.length;L>g;g++)i=N[g],s.type=i.getAttribute("creativeType")||"text/html",s.htmlResource=B.parseNodeText(i);for(A=B.childsByName(o,"IFrameResource"),_=0,w=A.length;w>_;_++)r=A[_],s.type=r.getAttribute("creativeType")||0,s.iframeResource=B.parseNodeText(r);for(U=B.childsByName(o,"StaticResource"),C=0,R=U.length;R>C;C++)a=U[C],s.type=a.getAttribute("creativeType")||0,s.staticResource=B.parseNodeText(a);s.nonlinearClickThroughURLTemplate=B.parseNodeText(B.childByName(o,"NonLinearClickThrough")),t.variations.push(s)}return t},e.parseCompanionAd=function(e){var t,n,i,r,s,l,u,c,h,p,d,f,v,m,g,y,T,k,L,w,R,_,C,x,b,E,N,A,U,B=this;for(i=new a,x=this.childsByName(e,"Companion"),f=0,y=x.length;y>f;f++){for(n=x[f],t=new o,t.id=n.getAttribute("id")||null,t.width=n.getAttribute("width"),t.height=n.getAttribute("height"),b=B.childsByName(n,"HTMLResource"),v=0,T=b.length;T>v;v++)s=b[v],t.type=s.getAttribute("creativeType")||"text/html",t.htmlResource=B.parseNodeText(s);for(E=B.childsByName(n,"IFrameResource"),m=0,k=E.length;k>m;m++)l=E[m],t.type=l.getAttribute("creativeType")||0,t.iframeResource=B.parseNodeText(l);for(N=B.childsByName(n,"StaticResource"),g=0,L=N.length;L>g;g++)u=N[g],t.type=u.getAttribute("creativeType")||0,t.staticResource=B.parseNodeText(u);for(A=B.childsByName(n,"TrackingEvents"),_=0,w=A.length;w>_;_++)for(h=A[_],U=B.childsByName(h,"Tracking"),C=0,R=U.length;R>C;C++)c=U[C],r=c.getAttribute("event"),p=B.parseNodeText(c),null!=r&&null!=p&&(null==(d=t.trackingEvents)[r]&&(d[r]=[]),t.trackingEvents[r].push(p));t.companionClickThroughURLTemplate=B.parseNodeText(B.childByName(n,"CompanionClickThrough")),i.variations.push(t)}return i},e.parseDuration=function(e){var t,n,i,r,s;return null==e?-1:(t=e.split(":"),3!==t.length?-1:(s=t[2].split("."),r=parseInt(s[0]),2===s.length&&(r+=parseFloat("0."+s[1])),i=parseInt(60*t[1]),n=parseInt(60*t[0]*60),isNaN(n||isNaN(i||isNaN(r||i>3600||r>60)))?-1:n+i+r))},e.parseNodeText=function(e){return e&&(e.textContent||e.text||"").trim()},e}(),t.exports=p},{"./ad":2,"./companionad":4,"./creative":5,"./mediafile":7,"./nonlinear":8,"./response":10,"./urlhandler":12,"./util":15,events:1}],10:[function(e,t,n){var i;i=function(){function e(){this.ads=[],this.errorURLTemplates=[]}return e}(),t.exports=i},{}],11:[function(e,t,n){var i,r,s,o,a,l={}.hasOwnProperty,u=function(e,t){function n(){this.constructor=e}for(var i in t)l.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=e("./client"),a=e("./util"),s=e("./creative").VASTCreativeLinear,i=e("events").EventEmitter,o=function(e){function t(e,t){var n,i,o,a=this;this.ad=e,this.creative=t,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],o=this.creative.trackingEvents;for(n in o)i=o[n],a.trackingEvents[n]=i.slice(0);this.creative instanceof s?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){r.lastSuccessfullAd=+new Date})}return u(t,e),t.prototype.setDuration=function(e){return this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},t.prototype.setProgress=function(e){var t,n,i,r,s,o,a,l,u,c=this;if(s=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,-1===s||this.skipable||(s>e?this.emit("skip-countdown",s-e):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(n=[],e>0){n.push("start"),i=Math.round(e/this.assetDuration*100),n.push("progress-"+i+"%"),n.push("progress-"+Math.round(e)),u=this.quartiles;for(r in u)o=u[r],e>=o&&o+1>=e&&n.push(r)}for(a=0,l=n.length;l>a;a++)t=n[a],c.track(t,!0);e<this.progress&&this.track("rewind")}return this.progress=e},t.prototype.setMuted=function(e){return this.muted!==e&&this.track(e?"mute":"unmute"),this.muted=e},t.prototype.setPaused=function(e){return this.paused!==e&&this.track(e?"pause":"resume"),this.paused=e},t.prototype.setFullscreen=function(e){return this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen"),this.fullscreen=e},t.prototype.setSkipDelay=function(e){return"number"==typeof e?this.skipDelay=e:void 0},t.prototype.load=function(){return this.impressed?void 0:(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView"))},t.prototype.errorWithCode=function(e){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:e})},t.prototype.complete=function(){return this.track("complete")},t.prototype.close=function(){return this.track(this.linear?"closeLinear":"close")},t.prototype.stop=function(){},t.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},t.prototype.click=function(){var e,t,n;return(null!=(n=this.clickTrackingURLTemplates)?n.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate?(this.linear&&(t={
CONTENTPLAYHEAD:this.progressFormated()}),e=a.resolveURLTemplates([this.clickThroughURLTemplate],t)[0],this.emit("clickthrough",e)):void 0},t.prototype.track=function(e,t){var n,i;null==t&&(t=!1),"closeLinear"===e&&null==this.trackingEvents[e]&&null!=this.trackingEvents.close&&(e="close"),i=this.trackingEvents[e],n=this.emitAlwaysEvents.indexOf(e),null!=i?(this.emit(e,""),this.trackURLs(i)):-1!==n&&this.emit(e,""),t===!0&&(delete this.trackingEvents[e],n>-1&&this.emitAlwaysEvents.splice(n,1))},t.prototype.trackURLs=function(e,t){return null==t&&(t={}),this.linear&&(t.CONTENTPLAYHEAD=this.progressFormated()),a.track(e,t)},t.prototype.progressFormated=function(){var e,t,n,i,r;return r=parseInt(this.progress),e=r/3600,e.length<2&&(e="0"+e),t=r/60%60,t.length<2&&(t="0"+t),i=r%60,i.length<2&&(i="0"+t),n=parseInt(100*(this.progress-r)),""+e+":"+t+":"+i+"."+n},t}(i),t.exports=o},{"./client":3,"./creative":5,"./util":15,events:1}],12:[function(e,t,n){var i,r,s;s=e("./urlhandlers/xmlhttprequest"),r=e("./urlhandlers/flash"),i=function(){function t(){}return t.get=function(t,n,i){return i||("function"==typeof n&&(i=n),n={}),n.urlhandler&&n.urlhandler.supported()?n.urlhandler.get(t,n,i):"undefined"==typeof window||null===window?e("./urlhandlers/node").get(t,n,i):s.supported()?s.get(t,n,i):r.supported()?r.get(t,n,i):i()},t}(),t.exports=i},{"./urlhandlers/flash":13,"./urlhandlers/xmlhttprequest":14}],13:[function(e,t,n){var i;i=function(){function e(){}return e.xdr=function(){var e;return window.XDomainRequest&&(e=new XDomainRequest),e},e.supported=function(){return!!this.xdr()},e.get=function(e,t,n){var i,r;return(r="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(r.async=!1,i=this.xdr(),i.open("GET",e),i.timeout=t.timeout||0,i.withCredentials=t.withCredentials||!1,i.send(),i.onprogress=function(){},i.onload=function(){return r.loadXML(i.responseText),n(null,r)}):n()},e}(),t.exports=i},{}],14:[function(e,t,n){var i;i=function(){function e(){}return e.xhr=function(){var e;return e=new window.XMLHttpRequest,"withCredentials"in e?e:void 0},e.supported=function(){return!!this.xhr()},e.get=function(e,t,n){var i;if("https:"===window.location.protocol&&0===e.indexOf("http://"))return n(new Error("Cannot go from HTTPS to HTTP."));try{return i=this.xhr(),i.open("GET",e),i.timeout=t.timeout||0,i.withCredentials=t.withCredentials||!1,i.send(),i.onreadystatechange=function(){return 4===i.readyState?n(null,i.responseXML):void 0}}catch(r){return n()}},e}(),t.exports=i},{}],15:[function(e,t,n){var i;i=function(){function e(){}return e.track=function(e,t){var n,i,r,s,o,a;for(i=this.resolveURLTemplates(e,t),a=[],s=0,o=i.length;o>s;s++)n=i[s],"undefined"!=typeof window&&null!==window&&(r=new Image,a.push(r.src=n));return a},e.resolveURLTemplates=function(e,t){var n,i,r,s,o,a,l,u,c;i=[],null==t&&(t={}),"CACHEBUSTING"in t||(t.CACHEBUSTING=Math.round(1e10*Math.random())),t.random=t.CACHEBUSTING;for(u=0,c=e.length;c>u;u++)if(n=e[u],a=n){for(r in t)l=t[r],s="["+r+"]",o="%%"+r+"%%",a=a.replace(s,l),a=a.replace(o,l);i.push(a)}return i},e.storage=function(){var e,t,n,i;try{n="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(r){i=r,n=null}return t=function(e){var t,n;try{if(n="__VASTUtil__",e.setItem(n,n),e.getItem(n)!==n)return!0}catch(i){return t=i,!0}return!1},(null==n||t(n))&&(e={},n={length:0,getItem:function(t){return e[t]},setItem:function(t,n){e[t]=n,this.length=Object.keys(e).length},removeItem:function(t){delete e[t],this.length=Object.keys(e).length},clear:function(){e={},this.length=0}}),n}(),e}(),t.exports=i},{}]},{},[6])(6)});var p={path:"http://videoplayer.dev",fbId:0xf87f5b1aced8},d=function(){var t,n=e(document).find("head"),i=[{tag:"link",options:{rel:"stylesheet",href:p.path+"/css/style.css"}},{tag:"link",options:{rel:"stylesheet",href:p.path+"/css/glyphter-font/css/adzicons.css"}},{tag:"script",options:{src:"https://www.youtube.com/iframe_api"}}];i.forEach(function(i){t="href",i.options[t]||(t="src"),e(document).find(i.tag+"["+t+'="'+i.options[t]+'"]',!0)||n.insertElement(i.tag,i.options)})},f=function(e){var t,n,i,r,s=[];for(i=0,r=e.length;r>i;i++)t=e[i],n={type:t.mimeType,src:t.fileURL},s.push({type:t.mimeType,src:t.fileURL,width:t.width,height:t.height});return s};new h({url:p.path+"/test/vast3.xml"}),window.fbAsyncInit=function(){FB.init({appId:p.fbId,xfbml:!0,version:"v2.6"})},function(e,t,n){var i,r=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(i,r))}(document,"script","facebook-jssdk")}();